"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t,n,r,o=require("react"),a=(e=o)&&"object"==typeof e&&"default"in e?e.default:e,i=require("three"),u=require("@react-three/drei"),s=require("@react-three/fiber"),c=999,l=0,m=function e(){c=0,t=setTimeout(e,5e3*Math.random()+2e3)},f=function(e,t,n){return void 0===n&&(n=.05),e*(1-n)+t*n},d=function(e,t,n,r,o){return((e=function(e,t,n){return Math.min(Math.max(e,t),n)}(e,t,n))-t)*(o-r)/(n-t)+r},h=function(e){return"SkinnedMesh"===e.type},v=Math.PI/180,p=90*v,E=!1,y=new i.Vector2(0,0),b=new i.Vector2(0,0),g=function(){r=setTimeout((function(){E=!0}),1e3)},x=function(){clearTimeout(r),E=!1},M=new i.Vector3(0,-.6,0);function T(e){var r=e.url,T=e.eyeBlink,L=e.headMovement,k=e.onLoaded,H=u.useGLTF(r),I=s.useGraph(H.scene),j=I.nodes,P=I.materials;return function(e,r){o.useEffect((function(){if(e)return(n=r.Wolf3D_Head||r.Wolf3D_Avatar).material.morphTargets=!0,n.morphTargetDictionary&&n.morphTargetInfluences&&(l=n.morphTargetDictionary.eyesClosed),t=setTimeout(m,1e3),function(){clearTimeout(t)}}),[r,e]),s.useFrame((function(t,r){if(e)if(c<2&&n.morphTargetInfluences){var o=Math.abs(Math.sin(c*Math.PI/2));c+=10*r,n.morphTargetInfluences[l]=o}else n.morphTargetInfluences&&(n.morphTargetInfluences[l]=0)}))}(T,j),function(e,t){var n=s.useThree().gl;o.useEffect((function(){if(e)return n.domElement.addEventListener("mouseleave",g),n.domElement.addEventListener("mouseenter",x),function(){n.domElement.removeEventListener("mouseleave",g),n.domElement.removeEventListener("mouseenter",x)}}),[n.domElement,e]),s.useFrame((function(n){if(e){var r=Math.abs(n.camera.rotation.z);!E&&r<.2?(y.x=d(n.mouse.y,-1,1,5*v,-5*v),y.y=d(n.mouse.x,-1,1,-10*v,10*v)):y.set(0,0),b.x=f(b.x,y.x),b.y=f(b.y,y.y),t.Neck.rotation.x=b.x+.1,t.Neck.rotation.y=b.y,t.Head.rotation.x=2*b.x,t.Head.rotation.y=2*b.y,t.RightEye.rotation.x=b.x-p,t.LeftEye.rotation.x=b.x-p,t.RightEye.rotation.z=3*b.y+Math.PI,t.LeftEye.rotation.z=3*b.y+Math.PI}}))}(L,j),o.useEffect((function(){return function(e){e.Wolf3D_Hands&&(e.Wolf3D_Hands.visible=!1),e.RightHand&&e.LeftHand&&(e.RightHand.position.set(0,-2,0),e.LeftHand.position.set(0,-2,0))}(j),function(e){Object.values(e).forEach((function(e){e.map&&(e.map.minFilter=i.LinearFilter),e&&(e.depthWrite=!0)}))}(P),k&&k(),function(){Object.values(P).forEach(s.dispose),Object.values(j).filter(h).forEach(s.dispose)}}),[P,j,r,k]),a.createElement("group",{position:M},a.createElement("primitive",{key:"armature",object:j.Hips}),Object.values(j).filter(h).map((function(e){return a.createElement("primitive",{key:e.name,object:e,receiveShadow:!0,castShadow:!0})})))}var L=function(){var e=u.useProgress();return a.createElement(u.Html,{center:!0},e.progress," % loaded")},k={width:"250px",height:"250px",backgroundColor:"orange",borderRadius:"100%"};exports.Loader=L,exports.default=function(e){var t=e.url,n=e.rotateAvatar,r=e.eyeBlink,i=e.headMovement,c=e.environment,l=void 0===c?"sunset":c;return a.createElement(s.Canvas,{style:e.style||k,camera:{fov:40,position:[0,0,.6]}},a.createElement(o.Suspense,{fallback:e.fallback||a.createElement(L,null)},l&&a.createElement(u.Environment,{preset:l}),n&&a.createElement(u.OrbitControls,{enablePan:!1,enableZoom:!1}),a.createElement(T,{url:t,eyeBlink:r,headMovement:i})))};
//# sourceMappingURL=avatar-view.cjs.production.min.js.map
